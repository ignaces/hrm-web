!function(a){function t(r){if(o[r])return o[r].exports;var d=o[r]={i:r,l:!1,exports:{}};return a[r].call(d.exports,d,d.exports,t),d.l=!0,d.exports}var o={};t.m=a,t.c=o,t.d=function(a,o,r){t.o(a,o)||Object.defineProperty(a,o,{configurable:!1,enumerable:!0,get:r})},t.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return t.d(o,"a",o),o},t.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)},t.p="",t(t.s=32)}({32:function(a,t,o){a.exports=o(33)},33:function(a,t){var o="",r="",d=0;$(document).ready(function(){$("#btnGuardarVenta").click(function(){if(!($(".idProducto")&&$(".idProducto").length>0))return swal("Advertencia","Debes ingresar al menos un producto para poder guardar la venta.","error"),!1;var a={},t=[];$(".idProducto").each(function(){idProducto=$(this).attr("id"),a={valor:0,cantidad:$("#idCantProd_"+idProducto).val(),precioUnitario:$("#idPrecioProdUn_"+idProducto).val(),fotoSku:"",idProducto:idProducto},t.push(a)});var o={};o={lat:"",lon:"",idCliente:$("#idCliente").val(),identificadorCliente:$("#rutCliente").val(),nombreCliente:$("#nombreCliente").val(),apellidoCliente:$("#apellidoCliente").val(),emailCliente:$("#emailCliente").val(),telefonoCliente:$("#telefonoCliente").val(),productos:JSON.stringify(t),_csrf:$("#_csrf").val()},$.ajax({url:"/Incentivo/Proceso/addVenta",type:"POST",data:o,dataType:"json",success:function(a){swal({title:"Venta Finalizada",text:"Venta guardada correctamente",type:"success",confirmButtonText:"Aceptar"}).then(function(a){location.href="/Incentivo/Proceso/colaboradores"})},error:function(a){console.log(a)}})}),$("#btnBuscarProducto").click(function(){var a={idProducto:$("#codigo_producto").val(),nombre:$("#txtNombreProducto").val(),marca:$("#txtMarcaProducto").val()};$.ajax({url:"/Incentivo/Proceso/getProductoPos",type:"GET",data:a,dataType:"json",success:function(a){0==a.length?(swal("Advertencia","Producto no existe","error"),o="",r="",d=0):(i.productos=a,$("#modalProductos").modal("show")),$("#caja_productos").show(),$("#prod_"+d)}})}),$("#agregar_producto").click(function(){if(0==$("#valor_cantidad").val()||""==$("#valor_cantidad").val()||0==$("#valor_cantidad").val().lengtg)return swal("Advertencia","Debes ingresar una cantidad válida.","error"),!1;if(0==$("#valor_precio").val()||""==$("#valor_precio").val()||0==$("#valor_precio").val().lengtg)return swal("Advertencia","Debes ingresar un precio válido","error"),!1;$("#fila_inicial").hide(),$("#tr_total").remove();var a="",t=1;$(".productos_ingresados").each(function(){t++});var o=0;$(".idProducto").each(function(){$("#id_producto").val()==$(this).attr("id")&&(o=$("#id_producto").val())});var r=0,d=0;if(0==o){r=$("#valor_cantidad").val(),d=$("#valor_precio").val()*$("#valor_cantidad").val();var e='"'+$("#id_producto").val()+'"';a="<tr class='productos_ingresados ' id='prod_"+$("#id_producto").val()+"'>",a=a+"<td><p class='nInvoice'>"+t+"</p> <input type='hidden' class='idProducto' id='"+$("#id_producto").val()+"' value='"+$("#id_producto").val()+"'> </td>",a=a+"<td>"+$("#valor_submarca").val()+" "+$("#valor_envase").val()+"</td>",a=a+"<td align='right'><input type='hidden' class='cantidadProd prod_"+$("#id_producto").val()+"' id='idCantProd_"+$("#id_producto").val()+"' value='"+$("#valor_cantidad").val()+"'><p id='txtCant_"+$("#id_producto").val()+"'>"+$("#valor_cantidad").val()+"</p></td>",a=a+"<td align='right'><input type='hidden' class='precioProdUn prod_"+$("#id_producto").val()+"' id='idPrecioProdUn_"+$("#id_producto").val()+"' value='"+$("#valor_precio").val()+"'> <input type='hidden' class='precioProd' id='idSumPrecios_"+$("#id_producto").val()+"' value='"+$("#valor_precio").val()*$("#valor_cantidad").val()+"'><p id='txtPrecio_"+$("#id_producto").val()+"'>$"+Math.round(d)+"</p></td>",a=a+"<td align='center' valign='middle' class='remProd' id='rem_prod_"+$("#id_producto").val()+"' style='cursor: pointer;'><i idProducto='"+e+"' class='fa fa-trash deleteProducto'></i></td>",a+="</tr>"}else{var i=parseInt($("#idCantProd_"+o).val())+parseInt($("#valor_cantidad").val()),n=parseInt($("#idSumPrecios_"+o).val())+parseInt(parseInt($("#valor_precio").val())*parseInt($("#valor_cantidad").val()));$("#idPrecioProdUn_"+o).val($("#valor_precio").val()),$("#idCantProd_"+o).val(i),$("#idSumPrecios_"+o).val(n),$("#txtCant_"+o).html(i),$("#txtPrecio_"+o).html("$"+n)}$(".cantidadProd").each(function(){r=parseInt(r)+parseInt($(this).val())}),$(".precioProd").each(function(){d=parseInt(d)+parseInt($(this).val())}),a+="<tr id='tr_total'>",a+="<td colspan='2' align='right' valign='middle'>Total:</td>",a=a+"<td align='right' valign='middle'>"+r+"</td>",a=a+"<td align='right' valign='middle'>$"+d+"</td>",a+="<td align='right' valign='middle'></td>",a+="</tr>",$("#tabla_invoice").append(a),$("#valor_submarca").val(""),$("#valor_envase").val(""),$("#valor_idproducto").val(""),$("#valor_cantidad").val(""),$("#valor_precio").val(""),$("#codigo_producto").val(""),$("#datos_producto").hide()}),$("#btn_camara").click(function(){e(),$("#modal-camara").modal("show")}),$(".deleteProducto").click(function(){console.log("remoce");var a=$(this).attr("idProducto");$("#prod_"+a).remove(),$("#tr_total").remove();var t=0,o=0;if($(".productos_ingresados").length>0){$(".cantidadProd").each(function(){t=parseInt(t)+parseInt($(this).val())}),$(".precioProd").each(function(){o=parseInt(o)+parseInt($(this).val())});var r="<tr id='tr_total'>";r+="<td colspan='2' align='right' valign='middle'>Total:</td>",r=r+"<td align='right' valign='middle'>"+t+"</td>",r=r+"<td align='right' valign='middle'>$"+o+"</td>",r+="<td align='right' valign='middle'></td>",r+="</tr>",$("#tabla_invoice").append(r);var d=1;$(".nInvoice").each(function(){$(this).html(d),d++})}else $("#fila_inicial").show()})});var e=function(){var a=new Instascan.Scanner({video:document.getElementById("scanner-container")});a.addListener("scan",function(a){$("#modal-camara").modal("hide"),$("#codigo_producto").val(a),$("#buscar_producto").trigger("click")}),Instascan.Camera.getCameras().then(function(t){t.length>0?t.length>1?a.start(t[1]):a.start(t[0]):console.error("No cameras found.")}).catch(function(a){console.error(a)})},i=new Vue({el:"#app",data:{productos:[{nombre:"test"}]},methods:{selectProducto:function(a){n.producto=a,$("#modalProductos").modal("hide")}}}),n=new Vue({el:"#fichaProducto",data:{producto:null}})}});